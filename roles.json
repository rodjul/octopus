{
    "Description": "Conjunto de roles, Policies e trusts",
    "TrustRelationships":[
        {
            "Name":"ADFS",
            "AssumeRolePolicyDocument":{
                "Version": "2012-10-17",
                "Statement": [	{
                     "Effect": "Allow",
                     "Principal": {
                         "Federated": "arn:aws:iam::ACCOUNT_ID:saml-provider/ADFS"
                     },
                     "Action": "sts:AssumeRoleWithSAML",
                     "Condition": {
                         "StringEquals": {
                           "SAML:aud": "https://signin.aws.amazon.com/saml"
                         }
                     }
                 } ]
             }
        },
        {
            "Name":"ateleiasystemmanager",
            "AssumeRolePolicyDocument":{
                "Version": "2012-10-17",
                 "Statement": [	{
                       "Sid": "",
                       "Effect": "Allow",
                       "Principal": {
                         "Service": [
                           "ssm.amazonaws.com",
                           "ec2.amazonaws.com"
                         ],
                         "AWS": "arn:aws:iam::994528329112:root"
                       },
                       "Action": "sts:AssumeRole"
                     
                 } ]
             }
        },
        {
            "Name":"cloudynRole",
            "AssumeRolePolicyDocument":{
                "Version": "2012-10-17",
                 "Statement": [	
                     {
                       "Sid": "assumecloudyn",
                       "Effect": "Allow",
                       "Principal": {
                         "AWS": "arn:aws:iam::432263259397:root"
                       },
                       "Action": "sts:AssumeRole",
                       "Condition": {
                         "StringEquals": {
                           "sts:ExternalId": "TOTVSSA1548775923529"
                         }
                       }
                     }
                 ]
             }
        },
        {
            "Name":"siemaudit",
            "AssumeRolePolicyDocument":{
                "Version": "2012-10-17",
                "Statement": [
                {
                  "Sid": "assumecrossaccountrole",
                  "Effect": "Allow",
                  "Principal": {
                    "AWS": "arn:aws:iam::461835337376:root"
                  },
                  "Action": "sts:AssumeRole"
                }
                ]
            }
        }

    ],
    "Policies":[
        {
            "Name":"policy-accessmngt",
            "Description": "This role is used to provide access to the Security team responsible for IDM. It provides full access to AWS IAM and ReadOnly access to other resources",
            "Path":"/",
            "PolicyDocument":{
				"Version": "2012-10-17",
				"Statement": [
					{
						"Sid": "accessmngt",
						"Effect": "Allow",
						"Action": [
							"iam:*",
							"cloudtrail:*",
							"support:*"
						],
						"Resource": "*",
						"Condition": {
							"IpAddress": {
								"aws:SourceIp": "187.94.52.20/32"
							}
						}
					}
				]
			}
        },
        {
            "Name":"policy-ateleiasystemmanager",
            "Description": "",
            "Path":"/",
            "PolicyDocument":{
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Sid": "VisualEditor0",
                        "Effect": "Allow",
                        "Action": [
                            "iam:GetRole",
                            "iam:PassRole",
                            "iam:ListGroupsForUser",
                            "iam:ListRoles",
                            "iam:CreateRole",
                            "iam:AttachRolePolicy",
                            "iam:ListGroups"
                        ],
                        "Resource": "*"
                    }
                ]
            }            
        },
        {
            "Name":"policy-businessops",
            "Description": "This role is used to provide access to the Business Ops team responsible for Cost Management. It provides full access to AWS Billing and Portal and ReadOnly access to other resources.",
            "Path":"/",
            "PolicyDocument":{
				"Version": "2012-10-17",
				"Statement": [
					{
						"Sid": "businessops",
						"Effect": "Allow",
						"Action": [
							"aws-portal:*",
							"awsbillingconsole:*",
							"budgets:*",
							"cur:*",
							"support:*"
						],
						"Resource": "*",
						"Condition": {
							"IpAddress": {
								"aws:SourceIp": "187.94.52.20/32"
							}
						}
					}
				]
			}            
        },
        {
            "Name":"policy-lionsplataform",
            "Description": "",
            "Path":"/",
            "PolicyDocument":{
				"Version": "2012-10-17",
				"Statement": [
					{
					"Sid": "lionsplatformDenyStopDeleteCloudtrail",
					"Effect": "Deny",
					"Action": [
						"cloudtrail:UpdateTrail",
						"cloudtrail:StopLogging",
						"cloudtrail:DeleteTrail",
						"cloudtrail:CreateTrail"
					],
					"Resource": "*"
				},
				{
					"Sid": "lionsplatformDenyWRITEPortal",
					"Effect": "Deny",
					"Action": [
						"aws-portal:ModifyPaymentMethods",
						"aws-portal:ModifyBilling",
						"aws-portal:ModifyAccount"
					],
					"Resource": "*"
				},
				{
					"Sid": "lionsplatformDenyWriteIAM",
					"Effect": "Deny",
					"Action": [
						"iam:UploadSigningCertificate",
						"iam:UploadSSHPublicKey",
						"iam:UpdateUser",
						"iam:UpdateSigningCertificate",
						"iam:UpdateSSHPublicKey",
						"iam:UpdateSAMLProvider",
						"iam:UpdateLoginProfile",
						"iam:UpdateGroup",
						"iam:UpdateAssumeRolePolicy",
						"iam:UpdateAccountPasswordPolicy",
						"iam:RemoveUserFromGroup",
						"iam:PutUserPolicy",
						"iam:PutGroupPolicy",
						"iam:DetachUserPolicy",
						"iam:DetachGroupPolicy",
						"iam:DeleteUserPolicy",
						"iam:DeleteUser",
						"iam:DeleteSigningCertificate",
						"iam:DeleteSSHPublicKey",
						"iam:DeleteSAMLProvider",
						"iam:DeletePolicyVersion",
						"iam:DeletePolicy",
						"iam:DeleteLoginProfile",
						"iam:DeleteGroupPolicy",
						"iam:DeleteGroup",
						"iam:DeleteAccountPasswordPolicy",
						"iam:DeactivateMFADevice",
						"iam:CreateUser",
						"iam:CreateSAMLProvider",
						"iam:CreateLoginProfile",
						"iam:CreateGroup",
						"iam:AttachUserPolicy",
						"iam:AttachGroupPolicy",
						"iam:AddUserToGroup"
					],
					"Resource": "*"
				},
				{
					"Sid": "lionsplatformDenyChangeManagedRoles",
					"Effect": "Deny",
					"Action": [
						"iam:SetDefaultPolicyVersion",
						"iam:PutRolePolicy",
						"iam:DetachRolePolicy",
						"iam:DeleteRolePolicy",
						"iam:DeleteRole",
						"iam:CreateRole",
						"iam:CreatePolicyVersion",
						"iam:CreatePolicy",
						"iam:AttachRolePolicy"
					],
					"Resource": [
						"arn:aws:iam::*:role/supportportal",
						"arn:aws:iam::*:role/lionsplatform",
						"arn:aws:iam::*:role/devopsplatform",
						"arn:aws:iam::*:role/businessops",
						"arn:aws:iam::*:role/accessmngt"
					]
				},
				{
					"Sid": "lionsplatformAllowFromIntranet",
					"Effect": "Allow",
					"Action": "*",
					"Resource": "*",
					"Condition": {
						"IpAddress": {
							"aws:SourceIp": "187.94.52.20/32"
						}
					}
				}
				]
			}            
        },
        {
            "Name":"policy-siemaudit",
            "Description": "",
            "Path":"/",
            "PolicyDocument":{
				"Version": "2012-10-17",
				"Statement": [
                    {
                       "Sid": "ReadAccessForSiem",
                       "Effect": "Allow",
                       "Action": [
                           "iam:GenerateCredentialReport",
                           "iam:GetPolicyVersion",
                           "iam:GetPolicy",
                           "iam:GetCredentialReport",
                           "iam:ListAttachedRolePolicies",
                           "iam:ListUsers",
                           "iam:ListAccessKeys",
                           "ec2:DescribeInstances",
                           "ec2:DescribeNetworkInterfaces",
                           "ec2:DescribeVpcs",
                           "cloudtrail:DescribeTrails",
                           "s3:GetBucketLocation"
                       ],
                       "Resource": "*"
                   }
               ]
			}            
        },
        {
            "Name":"policy-supportportal",
            "Description": "",
            "Path":"/",
            "PolicyDocument":{
				"Version": "2012-10-17",
				"Statement": [
					 {
						"Sid": "ReadAccessForSiem",
						"Effect": "Allow",
						"Action": [
							"iam:GenerateCredentialReport",
							"iam:GetPolicyVersion",
							"iam:GetPolicy",
							"iam:GetCredentialReport",
							"iam:ListAttachedRolePolicies",
							"iam:ListUsers",
							"iam:ListAccessKeys",
							"ec2:DescribeInstances",
							"ec2:DescribeNetworkInterfaces",
							"ec2:DescribeVpcs",
							"cloudtrail:DescribeTrails",
							"s3:GetBucketLocation"
						],
						"Resource": "*"
					}
				]
			}           
        }
    ],
    "Roles":[
        {
            "Name":"accessmngt",
            "Policies":[ "policy-accessmngt" ],
            "PolicyArnAWS":[],
            "TrustRelationship":"ADFS"
        },
        {
            "Name":"ateleia-systemmanager",
            "Policies":[ "policy-ateleiasystemmanager" ],
            "PolicyArnAWS":["arn:aws:iam::aws:policy/AmazonSSMFullAccess","arn:aws:iam::aws:policy/AmazonSNSFullAccess"],
            "TrustRelationship":"ateleiasystemmanager"            
        },
        {
            "Name":"businessops",
            "Policies":[ "policy-businessops" ],
            "PolicyArnAWS":[],
            "TrustRelationship":"ADFS"            
        },
        {
            "Name":"cloudynRole",
            "Policies":[ ],
            "PolicyArnAWS":[ "arn:aws:iam::aws:policy/ReadOnlyAccess" ],
            "TrustRelationship":"cloudynRole"            
        },
        {
            "Name":"lionsplatform",
            "Policies":[ "policy-lionsplataform" ],
            "PolicyArnAWS":[ ],
            "TrustRelationship":"ADFS"            
        },
        {
            "Name":"siemaudit",
            "Policies":[ "policy-siemaudit" ],
            "PolicyArnAWS":[ ],
            "TrustRelationship":"siemaudit"            
        },
        {
            "Name":"supportportal",
            "Policies":[ "policy-supportportal" ],
            "PolicyArnAWS":[ ],
            "TrustRelationship":"ADFS"            
        }
        
    ]
}
